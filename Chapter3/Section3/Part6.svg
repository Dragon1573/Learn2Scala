<svg ed:vSpacing="30" id="page100" ed:hSpacing="30" viewBox="0 0 714 617" xmlns:ed="https://www.edrawsoft.cn//xml/2017/SVGExtensions/" xmlns="http://www.w3.org/2000/svg" width="714" height="617" ed:name="Page-1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"><style type="text/css"><![CDATA[
g[ed\:togtopicid],g[ed\:hyperlink],g[ed\:comment],g[ed\:note] {cursor:pointer;}
g[id] {-moz-user-select: none;-ms-user-select: none;user-select: none;}
svg text::selection,svg tspan::selection{background-color: #4285f4;color: #ffffff;fill: #ffffff;}
.st1 {fill:#ffffff;font-family:微软雅黑;font-size:10pt}
]]></style><defs><linearGradient id="lg1" x1="0%" y1="0%" x2="0%" y2="100%"><stop stop-color="#ffffff" offset="0"/><stop stop-color="#f0f5f0" offset="0.25"/><stop stop-color="#e1ebe1" offset="0.75"/><stop stop-color="#c8d7c8" offset="1"/></linearGradient></defs><rect x="0" width="714" height="617" fill="#1e242f" y="0"/><path stroke-width="2" id="3035" ed:parentid="3027,3029,3031,3033" stroke="#e38d76" transform="matrix(1,0,0,1,345,477)" ed:idlist="3027,3029,3031,3033" fill="none" d="M0,0C0,0,5.2,-0.1,6.6,12.9C8,26,4.7,34.2,5.9,44.5C7,54.8,12,57.3,12,57.3C12,57.3,7.1,59.4,5.9,70C4.6,80.6,8,88.6,6.6,101.6C5.2,114.6,0,114.5,0,114.5" ed:type="summary" stroke-linejoin="round"/><path stroke-width="2" id="3037" ed:parentid="3014,3016,3018,3021,3023" stroke="#e38d76" transform="matrix(1,0,0,1,385,199)" ed:idlist="3014,3016,3018,3020,3021,3023" fill="none" d="M0,0C0,0,5.2,-0.3,6.6,27.3C8,54.9,4.7,72.2,5.9,94C7,115.8,12,120.9,12,120.9C12,120.9,7.1,125.3,5.9,147.8C4.6,170.2,8,187,6.6,214.5C5.2,242,0,241.8,0,241.8" ed:type="summary" stroke-linejoin="round"/><path stroke-width="2" id="3009" ed:parentid="3005,3007" stroke="#e38d76" transform="matrix(1,0,0,1,492,52)" ed:idlist="3005,3007,3012,3013" fill="none" d="M0,0C0,0,5.2,-0.2,6.6,15.8C8,31.8,4.7,41.8,5.9,54.4C7,67.1,12,70,12,70C12,70,7.1,72.6,5.9,85.6C4.6,98.6,8,108.3,6.6,124.2C5.2,140.1,0,140,0,140" ed:type="summary" stroke-linejoin="round"/><path stroke-width="2" id="3002" ed:parentid="2650" stroke="#e38d76" transform="matrix(1,0,0,1,107,82)" fill="none" ed:tosuperid="3001" stroke-linecap="round" d="M-13.5,36.6L3.7,36.6L3.7,-30.6C3.7,-33.9,6.4,-36.6,9.7,-36.6L13.5,-36.6" stroke-linejoin="round"/><path stroke-width="2" id="3004" ed:parentid="2650" stroke="#e38d76" transform="matrix(1,0,0,1,107,127)" fill="none" ed:tosuperid="3003" stroke-linecap="round" d="M3.7,-7.6L3.7,1.6C3.7,4.9,6.4,7.6,9.7,7.6L13.5,7.6" stroke-linejoin="round"/><path stroke-width="2" id="3006" ed:parentid="3003" stroke="#e38d76" transform="matrix(1,0,0,1,278,105)" fill="none" ed:tosuperid="3005" stroke-linecap="round" d="M-13.5,29.1L3.7,29.1L3.7,-23.1C3.7,-26.4,6.4,-29.1,9.7,-29.1L13.5,-29.1" stroke-linejoin="round"/><path stroke-width="2" id="3008" ed:parentid="3003" stroke="#e38d76" transform="matrix(1,0,0,1,278,163)" fill="none" ed:tosuperid="3007" stroke-linecap="round" d="M3.7,-29.1L3.7,23.1C3.7,26.4,6.4,29.1,9.7,29.1L13.5,29.1" stroke-linejoin="round"/><path stroke-width="2" id="3015" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,315)" fill="none" ed:tosuperid="3014" stroke-linecap="round" d="M-13.5,92.3L3.7,92.3L3.7,-86.3C3.7,-89.6,6.4,-92.3,9.7,-92.3L13.5,-92.3" stroke-linejoin="round"/><path stroke-width="2" id="3017" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,330)" fill="none" ed:tosuperid="3016" stroke-linecap="round" d="M3.7,77.2L3.7,-71.2C3.7,-74.5,6.4,-77.2,9.7,-77.2L13.5,-77.2" stroke-linejoin="round"/><path stroke-width="2" id="3019" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,385)" fill="none" ed:tosuperid="3018" stroke-linecap="round" d="M3.7,22.6L3.7,-16.6C3.7,-19.9,6.4,-22.6,9.7,-22.6L13.5,-22.6" stroke-linejoin="round"/><path stroke-width="2" id="3022" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,409)" fill="none" ed:tosuperid="3021" stroke-linecap="round" d="M3.7,-1.6C3.7,0.2,6.4,1.6,9.7,1.6L13.5,1.6" stroke-linejoin="round"/><path stroke-width="2" id="3024" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,424)" fill="none" ed:tosuperid="3023" stroke-linecap="round" d="M3.7,-16.7L3.7,10.7C3.7,14,6.4,16.7,9.7,16.7L13.5,16.7" stroke-linejoin="round"/><path stroke-width="2" id="3026" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,439)" fill="none" ed:tosuperid="3025" stroke-linecap="round" d="M3.7,-31.8L3.7,25.8C3.7,29.1,6.4,31.8,9.7,31.8L13.5,31.8" stroke-linejoin="round"/><path stroke-width="2" id="3028" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,454)" fill="none" ed:tosuperid="3027" stroke-linecap="round" d="M3.7,-46.9L3.7,40.9C3.7,44.2,6.4,46.9,9.7,46.9L13.5,46.9" stroke-linejoin="round"/><path stroke-width="2" id="3030" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,469)" fill="none" ed:tosuperid="3029" stroke-linecap="round" d="M3.7,-62.1L3.7,56.1C3.7,59.4,6.4,62.1,9.7,62.1L13.5,62.1" stroke-linejoin="round"/><path stroke-width="2" id="3032" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,484)" fill="none" ed:tosuperid="3031" stroke-linecap="round" d="M3.7,-77.2L3.7,71.2C3.7,74.5,6.4,77.2,9.7,77.2L13.5,77.2" stroke-linejoin="round"/><path stroke-width="2" id="3034" ed:parentid="2652" stroke="#e38d76" transform="matrix(1,0,0,1,107,499)" fill="none" ed:tosuperid="3033" stroke-linecap="round" d="M3.7,-92.3L3.7,86.3C3.7,89.6,6.4,92.3,9.7,92.3L13.5,92.3" stroke-linejoin="round"/><g ed:height="35" ed:width="178.6666666666667" id="3011" ed:parentid="3010" ed:topictype="callout" transform="matrix(1,0,0,1,513,65)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M4,0L174.7,0C177.4,0,178.7,1.3,178.7,4L178.7,31C178.7,33.7,177.4,35,174.7,35L93.9,35C91.2,35,88.9,35.8,86.9,37.6L83.6,40.4C81.5,42.2,80.3,41.7,79.7,39.1C79.2,36.3,77.6,35,74.9,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="14" y="21.3">用于并行执行任务的框架</tspan></text></g><g ed:height="35" ed:width="125.3333333333333" id="3012" ed:parentid="3007" ed:topictype="callout" transform="matrix(1,0,0,1,291,126)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M4,0L121.3,0C124,0,125.3,1.3,125.3,4L125.3,31C125.3,33.7,124,35,121.3,35L77.1,35C74.5,35,72.9,36.3,72.4,38.9C71.8,41.7,70.5,42.2,68.5,40.4L65.1,37.6C63.1,35.8,60.8,35,58.1,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="14" y="21.3">避免无意义等待</tspan></text></g><g ed:height="35" ed:width="196" id="3013" ed:parentid="3005" ed:topictype="callout" transform="matrix(1,0,0,1,291,84)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M4,0L69,0C71.7,0,72.5,-1.2,71.3,-3.6C69.7,-6.8,70.4,-7.6,72.9,-6.7L88.6,-1.3C91.2,-0.4,93.7,0,96.4,0L192,0C194.7,0,196,1.3,196,4L196,31C196,33.7,194.7,35,192,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="14" y="21.3">只要发生Shuffle必须写磁盘</tspan></text></g><g ed:height="35" ed:width="138.6666666666667" id="3020" ed:parentid="3018" ed:topictype="callout" transform="matrix(1,0,0,1,120,259)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M4,0L134.7,0C137.4,0,138.7,1.3,138.7,4L138.7,31C138.7,33.7,137.4,35,134.7,35L80.8,35C78.1,35,76.3,36.2,75.3,38.7C74,41.8,72.6,42,70.9,40L69.2,38C67.4,36,65.2,35,62.5,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="14" y="21.3">根据应用代码计算</tspan></text></g><g ed:height="23.75" ed:width="71.33329999999999" id="2650" ed:topictype="mainidea" transform="matrix(1,0,0,1,22,95)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L71.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">阶段划分</tspan></text></g><g ed:height="23.75" ed:width="71.33333333333334" id="2652" ed:topictype="mainidea" transform="matrix(1,0,0,1,22,383)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L71.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">运行过程</tspan></text></g><g ed:height="23.75" ed:width="167.3333333333333" id="3001" ed:parentid="2650" transform="matrix(1,0,0,1,120,22)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L167.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">每个作业就是一个DAG图</tspan></text></g><g ed:height="23.75" ed:width="144" id="3003" ed:parentid="2650" transform="matrix(1,0,0,1,120,110)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L144,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">以宽/窄依赖划分阶段</tspan></text></g><g ed:height="23.75" ed:width="111.3333333333333" id="3005" ed:parentid="3003" transform="matrix(1,0,0,1,291,52)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L111.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">宽依赖无法优化</tspan></text></g><g ed:height="23.75" ed:width="151.3333333333333" id="3007" ed:parentid="3003" transform="matrix(1,0,0,1,291,169)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L151.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">窄依赖可以流水线优化</tspan></text></g><g ed:height="29" ed:width="151.04" id="3010" ed:parentid="3009" transform="matrix(1,0,0,1,513,108)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M14.5,0L136.5,0C144.5,0,151,6.5,151,14.5C151,22.5,144.5,29,136.5,29L14.5,29C6.5,29,0,22.5,0,14.5C0,6.5,6.5,0,14.5,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="13" y="18.3">优化原理：fork/join</tspan></text></g><g ed:height="23.75" ed:width="173.3333333333333" id="3014" ed:parentid="2652" transform="matrix(1,0,0,1,120,199)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L173.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">从HDFS（磁盘）读入数据</tspan></text></g><g ed:height="23.75" ed:width="100" id="3016" ed:parentid="2652" transform="matrix(1,0,0,1,120,229)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L100,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">生成RDD对象</tspan></text></g><g ed:height="59.75" ed:width="156.6666666666667" id="3018" ed:parentid="2652" transform="matrix(1,0,0,1,120,302)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,59.8L156.7,59.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">生成SparkContext对象</tspan><tspan style="white-space:pre" x="8" y="33.3">计算RDD依赖关系</tspan><tspan style="white-space:pre" x="8" y="51.3">生成DAG图</tspan></text></g><g ed:height="41.75" ed:width="259.3333333333334" id="3021" ed:parentid="2652" transform="matrix(1,0,0,1,120,369)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,41.8L259.3,41.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">DAGScheduler将DAG图划分为多个阶段</tspan><tspan style="white-space:pre" x="8" y="33.3">每个阶段包含若干任务集和</tspan></text></g><g ed:height="23.75" ed:width="249.3333333333333" id="3023" ed:parentid="2652" transform="matrix(1,0,0,1,120,417)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L249.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">TaskScheduler向Work Node分配任务</tspan></text></g><g ed:height="23.75" ed:width="320" id="3025" ed:parentid="2652" transform="matrix(1,0,0,1,120,447)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L320,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">Work Node上的Executor派生出多个线程执行任务</tspan></text></g><g ed:height="23.75" ed:width="162" id="3027" ed:parentid="2652" transform="matrix(1,0,0,1,120,477)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L162,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">任务返回TaskScheduler</tspan></text></g><g ed:height="23.75" ed:width="163.3333333333333" id="3029" ed:parentid="2652" transform="matrix(1,0,0,1,120,508)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L163.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">向上返回DAGScheduler</tspan></text></g><g ed:height="23.75" ed:width="156.6666666666667" id="3031" ed:parentid="2652" transform="matrix(1,0,0,1,120,538)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L156.7,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">向上返回SparkContext</tspan></text></g><g ed:height="23.75" ed:width="219.3333333333333" id="3033" ed:parentid="2652" transform="matrix(1,0,0,1,120,568)"><path stroke-width="2" stroke="#e38d76" fill="none" d="M0,23.8L219.3,23.8" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="8" y="15.3">结果返回标准输出/HDFS（磁盘）</tspan></text></g><g ed:height="29" ed:width="142.3733333333333" id="3036" ed:parentid="3035" transform="matrix(1,0,0,1,366,520)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M14.5,0L127.9,0C135.9,0,142.4,6.5,142.4,14.5C142.4,22.5,135.9,29,127.9,29L14.5,29C6.5,29,0,22.5,0,14.5C0,6.5,6.5,0,14.5,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="13" y="18.3">相当于Reduce操作</tspan></text></g><g ed:height="29" ed:width="125.04" id="3038" ed:parentid="3037" transform="matrix(1,0,0,1,406,305)" ed:layout="rightmap"><path stroke-width="2" stroke="#e38d76" fill="none" d="M14.5,0L110.5,0C118.5,0,125,6.5,125,14.5C125,22.5,118.5,29,110.5,29L14.5,29C6.5,29,0,22.5,0,14.5C0,6.5,6.5,0,14.5,0z" stroke-linejoin="round"/><text class="st1"><tspan style="white-space:pre" x="13" y="18.3">相当于Map操作</tspan></text></g><g ed:togtopicid="2650" transform="translate(94,101)"><use xlink:href="#minus"/></g><g ed:togtopicid="2652" transform="translate(94,389)"><use xlink:href="#minus"/></g><g ed:togtopicid="3003" transform="translate(265,116)"><use xlink:href="#minus"/></g><symbol id="plus"><path fill="url(#lg1)" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z"/><path stroke-width="0.7" stroke="#46a000" fill="none" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6M6,3L6,9"/></symbol><symbol id="minus"><path fill="url(#lg1)" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z"/><path stroke-width="0.7" stroke="#46a000" fill="none" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6"/></symbol></svg>