<svg ed:vSpacing="30" xmlns:ev="http://www.w3.org/2001/xml-events" height="2289" xmlns:ed="https://www.edrawsoft.cn//xml/2017/SVGExtensions/" ed:hSpacing="30" width="1081" xmlns:xlink="http://www.w3.org/1999/xlink" ed:name="Page-1" viewBox="0 0 1081 2289" id="page100" xmlns="http://www.w3.org/2000/svg"><style type="text/css"><![CDATA[
g[ed\:togtopicid],g[ed\:hyperlink],g[ed\:comment],g[ed\:note] {cursor:pointer;}
g[id] {-moz-user-select: none;-ms-user-select: none;user-select: none;}
svg text::selection,svg tspan::selection{background-color: #4285f4;color: #ffffff;fill: #ffffff;}
.st3 {fill:#92d050;font-family:Cascadia Code;font-size:10pt}
.st2 {fill:#ffffff;font-family:Cascadia Code;font-size:10pt}
.st1 {fill:#ffffff;font-family:微软雅黑;font-size:10pt}
.st4 {font-family:Cascadia Code;font-size:9pt}
.st5 {font-family:Cascadia Code}
]]></style><defs><linearGradient x2="0%" x1="0%" y1="0%" y2="100%" id="lg1"><stop stop-color="#ffffff" offset="0"/><stop stop-color="#f0f5f0" offset="0.25"/><stop stop-color="#e1ebe1" offset="0.75"/><stop stop-color="#c8d7c8" offset="1"/></linearGradient></defs><rect height="2289" width="1081" y="0" fill="#1e242f" x="0"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4619" stroke-linejoin="round" d="M-13.5,15.1L3.7,15.1L3.7,-9.1C3.7,-12.4,6.4,-15.1,9.7,-15.1L13.5,-15.1" fill="none" stroke-width="2" ed:parentid="4485" id="4620" transform="matrix(1,0,0,1,175,61)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4621" stroke-linejoin="round" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" fill="none" stroke-width="2" ed:parentid="4485" id="4622" transform="matrix(1,0,0,1,175,76)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4623" stroke-linejoin="round" d="M3.7,-15.1L3.7,9.1C3.7,12.4,6.4,15.1,9.7,15.1L13.5,15.1" fill="none" stroke-width="2" ed:parentid="4485" id="4624" transform="matrix(1,0,0,1,175,91)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4625" stroke-linejoin="round" d="M-13.5,192L3.7,192L3.7,-186C3.7,-189.3,6.4,-192,9.7,-192L13.5,-192" fill="none" stroke-width="2" ed:parentid="4487" id="4626" transform="matrix(1,0,0,1,188,344)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4627" stroke-linejoin="round" d="M-13.5,7.6L3.7,7.6L3.7,-1.6C3.7,-4.9,6.4,-7.6,9.7,-7.6L13.5,-7.6" fill="none" stroke-width="2" ed:parentid="4625" id="4628" transform="matrix(1,0,0,1,359,144)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4629" stroke-linejoin="round" d="M3.7,-7.6L3.7,1.6C3.7,4.9,6.4,7.6,9.7,7.6L13.5,7.6" fill="none" stroke-width="2" ed:parentid="4625" id="4630" transform="matrix(1,0,0,1,359,159)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4631" stroke-linejoin="round" d="M3.7,0.2C3.7,-0,6.4,-0.2,9.7,-0.2L13.5,-0.2" fill="none" stroke-width="2" ed:parentid="4487" id="4632" transform="matrix(1,0,0,1,188,535)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4639" stroke-linejoin="round" d="M-13.5,65.6L3.7,65.6L3.7,-59.6C3.7,-62.9,6.4,-65.6,9.7,-65.6L13.5,-65.6" fill="none" stroke-width="2" ed:parentid="4631" id="4640" transform="matrix(1,0,0,1,359,470)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4642" stroke-linejoin="round" d="M3.7,0.4C3.7,-0,6.4,-0.4,9.7,-0.4L13.5,-0.4" fill="none" stroke-width="2" ed:parentid="4631" id="4643" transform="matrix(1,0,0,1,359,535)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4646" stroke-linejoin="round" d="M3.7,-35.2L3.7,29.2C3.7,32.5,6.4,35.2,9.7,35.2L13.5,35.2" fill="none" stroke-width="2" ed:parentid="4631" id="4647" transform="matrix(1,0,0,1,359,570)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4649" stroke-linejoin="round" d="M3.7,-65.4L3.7,59.4C3.7,62.7,6.4,65.4,9.7,65.4L13.5,65.4" fill="none" stroke-width="2" ed:parentid="4631" id="4650" transform="matrix(1,0,0,1,359,601)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4653" stroke-linejoin="round" d="M-13.5,15.1L3.7,15.1L3.7,-9.1C3.7,-12.4,6.4,-15.1,9.7,-15.1L13.5,-15.1" fill="none" stroke-width="2" ed:parentid="4649" id="4654" transform="matrix(1,0,0,1,544,651)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4655" stroke-linejoin="round" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" fill="none" stroke-width="2" ed:parentid="4649" id="4656" transform="matrix(1,0,0,1,544,666)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4657" stroke-linejoin="round" d="M3.7,-15.1L3.7,9.1C3.7,12.4,6.4,15.1,9.7,15.1L13.5,15.1" fill="none" stroke-width="2" ed:parentid="4649" id="4658" transform="matrix(1,0,0,1,544,681)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4661" stroke-linejoin="round" d="M3.7,-199.5L3.7,193.5C3.7,196.8,6.4,199.5,9.7,199.5L13.5,199.5" fill="none" stroke-width="2" ed:parentid="4487" id="4662" transform="matrix(1,0,0,1,188,735)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4663" stroke-linejoin="round" d="M-13.5,37.8L3.7,37.8L3.7,-31.8C3.7,-35.1,6.4,-37.8,9.7,-37.8L13.5,-37.8" fill="none" stroke-width="2" ed:parentid="4489" id="4664" transform="matrix(1,0,0,1,188,1033)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4665" stroke-linejoin="round" d="M-13.5,15.1L3.7,15.1L3.7,-9.1C3.7,-12.4,6.4,-15.1,9.7,-15.1L13.5,-15.1" fill="none" stroke-width="2" ed:parentid="4663" id="4666" transform="matrix(1,0,0,1,436,980)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4667" stroke-linejoin="round" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" fill="none" stroke-width="2" ed:parentid="4663" id="4668" transform="matrix(1,0,0,1,436,995)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4669" stroke-linejoin="round" d="M3.7,-15.1L3.7,9.1C3.7,12.4,6.4,15.1,9.7,15.1L13.5,15.1" fill="none" stroke-width="2" ed:parentid="4663" id="4670" transform="matrix(1,0,0,1,436,1010)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4671" stroke-linejoin="round" d="M3.7,-52.9L3.7,46.9C3.7,50.2,6.4,52.9,9.7,52.9L13.5,52.9" fill="none" stroke-width="2" ed:parentid="4489" id="4672" transform="matrix(1,0,0,1,188,1124)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4674" stroke-linejoin="round" d="M-13.5,63.1L3.7,63.1L3.7,-57.1C3.7,-60.4,6.4,-63.1,9.7,-63.1L13.5,-63.1" fill="none" stroke-width="2" ed:parentid="4496" id="4675" transform="matrix(1,0,0,1,215,1674)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4716" stroke-linejoin="round" d="M3.7,-97L3.7,91C3.7,94.3,6.4,97,9.7,97L13.5,97" fill="none" stroke-width="2" ed:parentid="4496" id="4717" transform="matrix(1,0,0,1,215,1834)"/><path stroke="#4badd0" stroke-linecap="round" ed:tosuperid="4718" stroke-linejoin="round" d="M3.7,-265.1L3.7,259.1C3.7,262.4,6.4,265.1,9.7,265.1L13.5,265.1" fill="none" stroke-width="2" ed:parentid="4496" id="4719" transform="matrix(1,0,0,1,215,2002)"/><g ed:height="35" ed:topictype="callout" ed:width="169.3333333333333" ed:layout="rightmap" ed:parentid="4631" id="4635" transform="matrix(1,0,0,1,201,173)"><path stroke="#4badd0" stroke-linejoin="round" d="M4,0L165.3,0C168,0,169.3,1.3,169.3,4L169.3,31C169.3,33.7,168,35,165.3,35L93,35C90.3,35,89,36.3,88.8,39L73,334.3C72.8,336.9,72.8,336.9,72.9,334.3L78.9,39C79,36.3,77.7,35,75,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="21.3" x="14">统一使用SparkSession</tspan></text></g><g ed:height="35" ed:topictype="callout" ed:width="382.6666666666667" ed:layout="rightmap" ed:parentid="4639" id="4644" transform="matrix(1,0,0,1,373,412)"><path stroke="#4badd0" stroke-linejoin="round" d="M4,0L219.3,0C222,0,224.6,-0.3,227.2,-0.8L258.3,-7.2C261,-7.7,261.1,-7.3,258.9,-5.9L252.7,-2.1C250.4,-0.7,250.6,0,253.3,0L378.7,0C381.4,0,382.7,1.3,382.7,4L382.7,31C382.7,33.7,381.4,35,378.7,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="21.3" x="14">Spark Shell交互式命令行不需要手动创建，系统会默认创建</tspan></text></g><g ed:height="35" ed:topictype="callout" ed:width="218" ed:layout="rightmap" ed:parentid="4642" id="4645" transform="matrix(1,0,0,1,373,454)"><path stroke="#4badd0" stroke-linejoin="round" d="M4,0L214,0C216.7,0,218,1.3,218,4L218,31C218,33.7,216.7,35,214,35L169.4,35C166.7,35,166.5,35.7,168.8,37.2L174.6,40.8C176.9,42.3,176.7,42.7,174,42.2L143.5,35.8C140.9,35.3,138.3,35,135.6,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="21.3" x="14">Spark SQL编程时需要显式创建</tspan></text></g><g ed:height="35" ed:topictype="callout" ed:width="232" ed:layout="rightmap" ed:parentid="4646" id="4648" transform="matrix(1,0,0,1,373,541)"><path stroke="#4badd0" stroke-linejoin="round" d="M4,0L228,0C230.7,0,232,1.3,232,4L232,31C232,33.7,230.7,35,228,35L132.5,35C129.9,35,128.4,36.3,128.2,39C128,41.7,126.8,42.2,124.7,40.7L119.9,37.3C117.7,35.8,115.4,35,112.7,35L4,35C1.3,35,0,33.7,0,31L0,4C0,1.3,1.3,0,4,0z" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="21.3" x="14">需要显式导入，才能启动隐式转换</tspan></text></g><g ed:height="113" ed:topictype="callout" ed:width="611.6145833333334" ed:layout="rightmap" ed:parentid="4671" id="4673" transform="matrix(1,0,0,1,201,1032)"><path stroke="#4badd0" stroke-linejoin="round" d="M4,0L607.6,0C610.3,0,611.6,1.3,611.6,4L611.6,109C611.6,111.7,610.3,113,607.6,113L162.1,113C159.4,113,156.8,113.3,154.2,113.8L122.1,120.2C119.5,120.7,119.3,120.3,121.7,119L128.4,115C130.7,113.7,130.5,113,127.8,113L4,113C1.3,113,0,111.7,0,109L0,4C0,1.3,1.3,0,4,0z" fill="none" stroke-width="2"/><text class="st2"><tspan style="white-space:pre" y="20.3" x="14">scala> val peopleDF = spark.read.format("json").load("file:///usr/local/</tspan><tspan style="white-space:pre" y="36.3" x="14">spark/examples/src/main/resources/people.json")</tspan><tspan style="white-space:pre" y="52.3" x="14">peopleDF: org.apache.spark.sql.DataFrame = [age: bigint, name: string]</tspan><tspan style="white-space:pre" y="84.3" x="14">scala> peopleDF.select("name", "age").write.format("csv").save("file:///</tspan><tspan style="white-space:pre" y="100.3" x="14">home/dragon1573/Code/peopleCopy.csv")</tspan></text></g><g ed:height="23.75" ed:topictype="mainidea" ed:width="139" id="4485" transform="matrix(1,0,0,1,22,52)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L139,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">6.2.DataFrame概述</tspan></text></g><g ed:height="23.75" ed:topictype="mainidea" ed:width="152.333" id="4487" transform="matrix(1,0,0,1,22,512)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L152.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">6.3.DataFrame的创建</tspan></text></g><g ed:height="23.75" ed:topictype="mainidea" ed:width="152.3333333333333" id="4489" transform="matrix(1,0,0,1,22,1047)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L152.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">6.4.DataFrame的保存</tspan></text></g><g ed:height="23.75" ed:topictype="mainidea" ed:width="179" id="4496" transform="matrix(1,0,0,1,22,1713)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L179,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">6.5.DataFrame的常用操作</tspan></text></g><g ed:height="23.75" ed:width="260" ed:parentid="4485" id="4619" transform="matrix(1,0,0,1,188,22)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L260,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">Spark SQL就是对DataFrame的转换操作</tspan></text></g><g ed:height="23.75" ed:width="273.3333333333333" ed:parentid="4485" id="4621" transform="matrix(1,0,0,1,188,52)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L273.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">RDD中的对象是被封装的，内部结构被屏蔽</tspan></text></g><g ed:height="23.75" ed:width="247.3333333333333" ed:parentid="4485" id="4623" transform="matrix(1,0,0,1,188,83)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L247.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">DataFrame就是带有结构化信息的表格</tspan></text></g><g ed:height="23.75" ed:width="144.6666666666667" ed:parentid="4487" id="4625" transform="matrix(1,0,0,1,201,128)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L144.7,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">Spark 1.6及前序版本</tspan></text></g><g ed:height="23.75" ed:width="92" ed:parentid="4625" id="4627" transform="matrix(1,0,0,1,373,113)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L92,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">SQLContext</tspan></text></g><g ed:height="23.75" ed:width="94.66666666666667" ed:parentid="4625" id="4629" transform="matrix(1,0,0,1,373,143)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L94.7,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">HiveContext</tspan></text></g><g ed:height="23.75" ed:width="144.6666666666667" ed:parentid="4487" id="4631" transform="matrix(1,0,0,1,201,512)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L144.7,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">Spark 2.0及后续版本</tspan></text></g><g ed:height="53.75" ed:width="674" ed:parentid="4631" id="4639" transform="matrix(1,0,0,1,373,350)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,53.8L674,53.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="14.3" x="8">$ spark-shell</tspan><tspan style="white-space:pre" y="30.3" x="8">Spark context available as 'sc' (master = local[*], app id = local-1584363640477).</tspan><tspan style="white-space:pre" y="46.3" x="8">Spark session available as 'spark'.</tspan></text></g><g ed:height="37.75" ed:width="458" ed:parentid="4631" id="4642" transform="matrix(1,0,0,1,373,497)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,37.8L458,37.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="14.3" x="8">scala> import org.apache.spark.sql.SparkSession</tspan><tspan style="white-space:pre" y="30.3" x="8">scala> val spark = SparkSession.builder().getOrCreate()</tspan></text></g><g ed:height="21.75" ed:width="266" ed:parentid="4631" id="4646" transform="matrix(1,0,0,1,373,584)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,21.8L266,21.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="14.3" x="8">scala> import spark.implicits._</tspan></text></g><g ed:height="23.75" ed:width="158" ed:parentid="4631" id="4649" transform="matrix(1,0,0,1,373,642)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L158,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">读取方法：</tspan><tspan style="white-space:pre" class="st4">spark.read</tspan></text></g><g ed:height="23.75" ed:width="207.3333333333333" ed:parentid="4649" id="4653" transform="matrix(1,0,0,1,558,612)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L207.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st5" y="15.3" x="8">.json(path)</tspan><tspan style="white-space:pre">，读取JSON文件</tspan></text></g><g ed:height="23.75" ed:width="246" ed:parentid="4649" id="4655" transform="matrix(1,0,0,1,558,642)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L246,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st5" y="15.3" x="8">.parquet(path)</tspan><tspan style="white-space:pre">，读取Parquet文件</tspan></text></g><g ed:height="23.75" ed:width="190.6666666666667" ed:parentid="4649" id="4657" transform="matrix(1,0,0,1,558,673)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L190.7,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st5" y="15.3" x="8">.csv(path)</tspan><tspan style="white-space:pre">，读取CSV文件</tspan></text></g><g ed:height="231.75" ed:width="858" ed:parentid="4487" id="4661" transform="matrix(1,0,0,1,201,703)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,231.8L858,231.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="16.3" x="8">scala> import spark.implicits._      // 启用RDD转换为DataFrame支持，以及后续SQL操作</tspan><tspan style="white-space:pre" y="32.3" x="8">import spark.implicits._</tspan><tspan style="white-space:pre" y="64.3" x="8">scala> val dataframe = spark.read.json("file:///usr/local/spark/examples/src/main/resources/people.json")</tspan><tspan style="white-space:pre" y="80.3" x="8">dataframe: org.apache.spark.sql.DataFrame = [age: bigint, name: string]         </tspan><tspan style="white-space:pre" y="112.3" x="8">scala> dataframe.show()</tspan><tspan style="white-space:pre" y="128.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="144.3" x="8">| age|   name|</tspan><tspan style="white-space:pre" y="160.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="176.3" x="8">|null|Michael|</tspan><tspan style="white-space:pre" y="192.3" x="8">|  30|   Andy|</tspan><tspan style="white-space:pre" y="208.3" x="8">|  19| Justin|</tspan><tspan style="white-space:pre" y="224.3" x="8">+----+-------+</tspan></text></g><g ed:height="23.75" ed:width="221.3333333333333" ed:parentid="4489" id="4663" transform="matrix(1,0,0,1,201,971)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L221.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">使用</tspan><tspan style="white-space:pre" class="st4">spark.write</tspan><tspan style="white-space:pre">保存DataFrame</tspan></text></g><g ed:height="23.75" ed:width="188.6666666666667" ed:parentid="4663" id="4665" transform="matrix(1,0,0,1,450,941)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L188.7,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st5" y="15.3" x="8">.json()</tspan><tspan style="white-space:pre">，保存为JSON文件</tspan></text></g><g ed:height="23.75" ed:width="227.3333333333333" ed:parentid="4663" id="4667" transform="matrix(1,0,0,1,450,971)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L227.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st5" y="15.3" x="8">.parquet()</tspan><tspan style="white-space:pre">，保存为Parquet文件</tspan></text></g><g ed:height="23.75" ed:width="168" ed:parentid="4663" id="4669" transform="matrix(1,0,0,1,450,1002)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L168,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" class="st4" y="15.3" x="8">.csv()</tspan><tspan style="white-space:pre">，保存为CSV文件</tspan></text></g><g ed:height="23.75" ed:width="167.3333333333333" ed:parentid="4489" id="4671" transform="matrix(1,0,0,1,201,1153)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,23.8L167.3,23.8" fill="none" stroke-width="2"/><text class="st1"><tspan style="white-space:pre" y="15.3" x="8">先读取JSON再回写JSON</tspan></text></g><g ed:height="427.75" ed:width="604.8333333333334" ed:parentid="4496" id="4674" transform="matrix(1,0,0,1,228,1183)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,427.8L604.8,427.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="14.3" x="8">scala> val dataframe = spark.read.json("file:///usr/local/spark/examples/</tspan><tspan style="white-space:pre" y="30.3" x="8">src/main/resources/people.json")</tspan><tspan style="white-space:pre" y="46.3" x="8">dataframe: org.apache.spark.sql.DataFrame = [age: bigint, name: string]</tspan><tspan style="white-space:pre" y="80.3" x="8">scala> dataframe.printSchema()      // 打印模式信息</tspan><tspan style="white-space:pre" y="96.3" x="8">root</tspan><tspan style="white-space:pre" y="112.3" x="8"> |-- age: long (nullable = true)</tspan><tspan style="white-space:pre" y="128.3" x="8"> |-- name: string (nullable = true)</tspan><tspan style="white-space:pre" y="162.3" x="8">// 选择多个列并直接进行计算</tspan><tspan style="white-space:pre" y="178.3" x="8">scala> dataframe.select(dataframe("name"), dataframe("age") + 1).show()</tspan><tspan style="white-space:pre" y="194.3" x="8">+-------+---------+</tspan><tspan style="white-space:pre" y="210.3" x="8">|   name|(age + 1)|</tspan><tspan style="white-space:pre" y="226.3" x="8">+-------+---------+</tspan><tspan style="white-space:pre" y="242.3" x="8">|Michael|     null|</tspan><tspan style="white-space:pre" y="258.3" x="8">|   Andy|       31|</tspan><tspan style="white-space:pre" y="274.3" x="8">| Justin|       20|</tspan><tspan style="white-space:pre" y="290.3" x="8">+-------+---------+</tspan><tspan style="white-space:pre" y="324.3" x="8">// 条件过滤</tspan><tspan style="white-space:pre" y="340.3" x="8">scala> dataframe.filter(dataframe("age") > 20).show()</tspan><tspan style="white-space:pre" y="356.3" x="8">+---+----+</tspan><tspan style="white-space:pre" y="372.3" x="8">|age|name|</tspan><tspan style="white-space:pre" y="388.3" x="8">+---+----+</tspan><tspan style="white-space:pre" y="404.3" x="8">| 30|Andy|</tspan><tspan style="white-space:pre" y="420.3" x="8">+---+----+</tspan></text></g><g ed:height="313.75" ed:width="426" ed:parentid="4496" id="4716" transform="matrix(1,0,0,1,228,1617)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,313.8L426,313.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="16.3" x="8">// 分组聚合</tspan><tspan style="white-space:pre" y="32.3" x="8">scala> dataframe.groupBy("age").count().show()</tspan><tspan style="white-space:pre" y="48.3" x="8">+----+-----+</tspan><tspan style="white-space:pre" y="64.3" x="8">| age|count|</tspan><tspan style="white-space:pre" y="80.3" x="8">+----+-----+</tspan><tspan style="white-space:pre" y="96.3" x="8">|  19|    1|</tspan><tspan style="white-space:pre" y="112.3" x="8">|null|    1|</tspan><tspan style="white-space:pre" y="128.3" x="8">|  30|    1|</tspan><tspan style="white-space:pre" y="144.3" x="8">+----+-----+</tspan><tspan style="white-space:pre" y="178.3" x="8">// 排序</tspan><tspan style="white-space:pre" y="194.3" x="8">scala> dataframe.sort(dataframe("age").desc).show()</tspan><tspan style="white-space:pre" y="210.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="226.3" x="8">| age|   name|</tspan><tspan style="white-space:pre" y="242.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="258.3" x="8">|  30|   Andy|</tspan><tspan style="white-space:pre" y="274.3" x="8">|  19| Justin|</tspan><tspan style="white-space:pre" y="290.3" x="8">|null|Michael|</tspan><tspan style="white-space:pre" y="306.3" x="8">+----+-------+</tspan></text></g><g ed:height="329.75" ed:width="612" ed:parentid="4496" id="4718" transform="matrix(1,0,0,1,228,1938)"><path stroke="#4badd0" stroke-linejoin="round" d="M0,329.8L612,329.8" fill="none" stroke-width="2"/><text class="st3"><tspan style="white-space:pre" y="16.3" x="8">// 多列排序</tspan><tspan style="white-space:pre" y="32.3" x="8">scala> dataframe.sort(dataframe("age").desc, dataframe("name").asc).show()</tspan><tspan style="white-space:pre" y="48.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="64.3" x="8">| age|   name|</tspan><tspan style="white-space:pre" y="80.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="96.3" x="8">|  30|   Andy|</tspan><tspan style="white-space:pre" y="112.3" x="8">|  19| Justin|</tspan><tspan style="white-space:pre" y="128.3" x="8">|null|Michael|</tspan><tspan style="white-space:pre" y="144.3" x="8">+----+-------+</tspan><tspan style="white-space:pre" y="178.3" x="8">// 对列进行重命名</tspan><tspan style="white-space:pre" y="194.3" x="8">scala> dataframe.select(dataframe("name").as("username"), </tspan><tspan style="white-space:pre" y="210.3" x="8">dataframe("age")).show()</tspan><tspan style="white-space:pre" y="226.3" x="8">+--------+----+</tspan><tspan style="white-space:pre" y="242.3" x="8">|username| age|</tspan><tspan style="white-space:pre" y="258.3" x="8">+--------+----+</tspan><tspan style="white-space:pre" y="274.3" x="8">| Michael|null|</tspan><tspan style="white-space:pre" y="290.3" x="8">|    Andy|  30|</tspan><tspan style="white-space:pre" y="306.3" x="8">|  Justin|  19|</tspan><tspan style="white-space:pre" y="322.3" x="8">+--------+----+</tspan></text></g><g ed:togtopicid="4485" transform="translate(162,58)"><use xlink:href="#minus"/></g><g ed:togtopicid="4487" transform="translate(175,518)"><use xlink:href="#minus"/></g><g ed:togtopicid="4489" transform="translate(175,1053)"><use xlink:href="#minus"/></g><g ed:togtopicid="4496" transform="translate(202,1719)"><use xlink:href="#minus"/></g><g ed:togtopicid="4625" transform="translate(347,134)"><use xlink:href="#minus"/></g><g ed:togtopicid="4631" transform="translate(347,517)"><use xlink:href="#minus"/></g><g ed:togtopicid="4649" transform="translate(532,648)"><use xlink:href="#minus"/></g><g ed:togtopicid="4663" transform="translate(424,977)"><use xlink:href="#minus"/></g><symbol id="plus"><path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg1)"/><path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6M6,3L6,9" fill="none" stroke-width="0.7"/></symbol><symbol id="minus"><path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg1)"/><path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6" fill="none" stroke-width="0.7"/></symbol></svg>